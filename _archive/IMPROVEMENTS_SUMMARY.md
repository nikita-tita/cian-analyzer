# –£–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏

## –î–∞—Ç–∞: 2025-11-16

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¢–µ—Å—Ç 1: –ñ–ö "–õ–°–†. –ë–æ–ª—å—à–∞—è –û—Ö—Ç–∞") –≤—ã—è–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
- ‚ö†Ô∏è **–†–∞–∑–±—Ä–æ—Å —Ü–µ–Ω 76%** - –∫—Ä–∏—Ç–∏—á–Ω–æ –≤—ã—Å–æ–∫–∏–π
- ‚ö†Ô∏è **–ì–µ–æ-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –∞–Ω–∞–ª–æ–≥–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ (–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π vs —Ü–µ–Ω—Ç—Ä)
- ‚ö†Ô∏è **–¶–µ–Ω–æ–≤–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è** - —à–∏—Ä–æ–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω (8.8 - 12+ –º–ª–Ω)

## –í–Ω–µ–¥—Ä–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ –∑–∞ –º¬≤ (¬±30%) ‚úÖ
**–§–∞–π–ª:** `src/parsers/playwright_parser.py:716-729`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–Ω—ã –∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä —Å –¥–æ–ø—É—Å–∫–æ–º ¬±30%

**–ö–æ–¥:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ù–û–í–û–ï - –¶–µ–Ω–∞ –∑–∞ –º¬≤ –Ω–µ –¥–æ–ª–∂–Ω–∞ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ ¬±30%
target_price_per_sqm = target_price / target_area
comp_price_per_sqm = comp_price / comp_area
price_per_sqm_diff = abs(comp_price_per_sqm - target_price_per_sqm) / target_price_per_sqm

if price_per_sqm_diff > 0.30:  # ¬±30%
    unreasonable_count += 1
    logger.warning(...)
    continue
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ò—Å–∫–ª—é—á–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏ —Å —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–ª–∏—á–∞—é—â–µ–π—Å—è —Ü–µ–Ω–æ–π/–º¬≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–∑ –¥—Ä—É–≥–∏—Ö —Ä–∞–π–æ–Ω–æ–≤ (–≥–¥–µ —Ü–µ–Ω—ã –≤—ã—à–µ/–Ω–∏–∂–µ)
- –°–Ω–∏–∂–∞–µ—Ç —Ä–∞–∑–±—Ä–æ—Å —Å 76% –¥–æ –æ–∂–∏–¥–∞–µ–º—ã—Ö ~20-30%

### 2. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤ –∏–∑ —Ç–æ–≥–æ –∂–µ –ñ–ö ‚úÖ
**–§–∞–π–ª:** `src/parsers/playwright_parser.py:1577-1602`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ - –∞–Ω–∞–ª–æ–≥–∏ –∏–∑ —Ç–æ–≥–æ –∂–µ –ñ–ö –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è –≤—ã—à–µ –≤ —Å–ø–∏—Å–∫–µ

**–ö–æ–¥:**
```python
target_rc = target_property.get('residential_complex', '').lower().strip()
if target_rc and len(final_results) > 0:
    def sort_key(result):
        same_rc = target_rc in result_title or target_rc in result_address
        price_diff = abs(result_price_per_sqm - target_price_per_sqm)
        return (not same_rc, price_diff)  # –°–Ω–∞—á–∞–ª–∞ –∏–∑ –ñ–ö, –∑–∞—Ç–µ–º –ø–æ —Ü–µ–Ω–µ

    final_results.sort(key=sort_key)
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ê–Ω–∞–ª–æ–≥–∏ –∏–∑ —Ç–æ–≥–æ –∂–µ –ñ–ö –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏
- –í–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏ —Ü–µ–Ω—ã/–º¬≤
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–±–æ—Ä–∞

### 3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–¥–±–æ—Ä–∞ ‚úÖ
**–§–∞–π–ª:** `src/parsers/playwright_parser.py:1613-1646`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∏ –≤—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–∞–∑–±—Ä–æ—Å–∞ —Ü–µ–Ω

**–ö–æ–¥:**
```python
prices_per_sqm = [price/area for result in final_results if price > 0 and area > 0]
spread = ((max_price_sqm - min_price_sqm) / min_price_sqm) * 100

logger.info("üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ö–ê–ß–ï–°–¢–í–ê –ü–û–î–ë–û–†–ê:")
logger.info(f"   - –ú–∏–Ω —Ü–µ–Ω–∞/–º¬≤: {min_price_sqm:,.0f} ‚ÇΩ")
logger.info(f"   - –ú–∞–∫—Å —Ü–µ–Ω–∞/–º¬≤: {max_price_sqm:,.0f} ‚ÇΩ")
logger.info(f"   - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞/–º¬≤: {avg_price_sqm:,.0f} ‚ÇΩ")
logger.info(f"   - –†–∞–∑–±—Ä–æ—Å: {spread:.0f}%")

if spread > 50:
    logger.warning(f"‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –†–∞–∑–±—Ä–æ—Å —Ü–µ–Ω {spread:.0f}% –ø—Ä–µ–≤—ã—à–∞–µ—Ç 50%!")
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–¥–±–æ—Ä–∞
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º —Ä–∞–∑–±—Ä–æ—Å–µ (>50%)
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏

## –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã (—É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç)

### –ì–µ–æ-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
**–§–∞–π–ª:** `src/parsers/playwright_parser.py:1198-1268`

–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ:
- –ú–µ—Ç—Ä–æ (strict mode) - —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏
- –†–∞–π–æ–Ω—É (non-strict mode) - —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∞–¥—Ä–µ—Å–∞
- –†–µ–≥–∏–æ–Ω—É (SPB/MSK) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:** –ù–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ/–º¬≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–∑ –¥—Ä—É–≥–∏—Ö —Ä–∞–π–æ–Ω–æ–≤

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ —É–ª—É—á—à–µ–Ω–∏–π | –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π |
|---------|--------------|-----------------|
| –†–∞–∑–±—Ä–æ—Å —Ü–µ–Ω | 76% | ~20-30% |
| –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å | 7/10 | 9/10 |
| –ê–Ω–∞–ª–æ–≥–∏ –∏–∑ –ñ–ö | –í–ø–µ—Ä–µ–º–µ—à–∫—É | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
| –ì–µ–æ-—Ç–æ—á–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¢–µ—Å—Ç 1 –ø–æ–≤—Ç–æ—Ä–Ω–æ (–ñ–ö "–õ–°–†. –ë–æ–ª—å—à–∞—è –û—Ö—Ç–∞")
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–±—Ä–æ—Å —Ü–µ–Ω –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–Ω–∞–ª–æ–≥–∏ –∏–∑ —Ç–æ–≥–æ –∂–µ –ñ–ö –≤—ã—à–µ –≤ —Å–ø–∏—Å–∫–µ
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¢–µ—Å—Ç—ã 2-5 –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ö

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å
‚úÖ API –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è

## –ê–≤—Ç–æ—Ä
Claude Code
