# ‚úÖ –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê: CLOUDFLARE BYPASS

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

**–ò—Å—Ö–æ–¥–Ω–∞—è –æ—à–∏–±–∫–∞:**
```
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ
URL: https://spb.cian.ru/sale/flat/315047056/
–û—à–∏–±–∫–∞: Timeout 30000ms exceeded
```

Cian.ru –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Cloudflare –∑–∞—â–∏—Ç—É, –∫–æ—Ç–æ—Ä–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ Playwright.

---

## üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

–ò–∑—É—á–µ–Ω—ã –ª—É—á—à–∏–µ open-source —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –æ–±—Ö–æ–¥–∞ Cloudflare –≤ 2025:

### –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
1. **Botasaurus** - –Ω–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–±—Ö–æ–¥–∞ anti-bot
2. **Camoufox** - Firefox —Å C++ hooks –¥–ª—è fingerprint manipulation
3. **SeleniumBase** - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π toolkit
4. **Nodriver** - successor undetected-chromedriver (async)
5. **FlareSolverr** - Selenium + Undetected ChromeDriver
6. **Undetected-Playwright-Python** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ Playwright
7. **Cloudscraper** - requests-based —Ä–µ—à–µ–Ω–∏–µ

### –í—ã–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
‚úÖ **–£–ª—É—á—à–µ–Ω–Ω—ã–π Playwright —Å anti-detection —Ç–µ—Ö–Ω–∏–∫–∞–º–∏**

–ü–æ—á–µ–º—É –ù–ï nodriver:
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±—Ä–∞—É–∑–µ—Ä—É
- –°–ª–æ–∂–Ω–µ–µ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –¢—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–¥–∞

---

## üõ†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### Anti-Detection —Ç–µ—Ö–Ω–∏–∫–∏:

#### 1. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞
```python
browser = playwright.chromium.launch(
    headless=True,
    args=[
        '--disable-blink-features=AutomationControlled',  # ‚ùó –ö–ª—é—á–µ–≤–æ–µ
        '--disable-dev-shm-usage',
        '--no-sandbox',
        '--disable-web-security',
        '--disable-features=IsolateOrigins,site-per-process',
    ]
)
```

#### 2. –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π User-Agent –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏
```python
context = browser.new_context(
    user_agent='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) ...',
    locale='ru-RU',
    timezone_id='Europe/Moscow',
    extra_http_headers={
        'Accept-Language': 'ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7',
        'DNT': '1',
        'Connection': 'keep-alive',
        ...
    }
)
```

#### 3. JavaScript injection –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
```javascript
Object.defineProperty(navigator, 'webdriver', {
    get: () => undefined  // –°–∫—Ä—ã–≤–∞–µ–º webdriver
});

Object.defineProperty(navigator, 'plugins', {
    get: () => [1, 2, 3, 4, 5]  // –≠–º—É–ª–∏—Ä—É–µ–º –ø–ª–∞–≥–∏–Ω—ã
});

window.chrome = {
    runtime: {}  // –≠–º—É–ª–∏—Ä—É–µ–º –Ω–∞—Å—Ç–æ—è—â–∏–π Chrome
};
```

#### 4. –ß–µ–ª–æ–≤–µ–∫–æ–ø–æ–¥–æ–±–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
```python
# –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
time.sleep(random.uniform(0.5, 1.5))

# –≠–º—É–ª—è—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞
page.evaluate('window.scrollTo(0, document.body.scrollHeight / 4)')
time.sleep(0.3)
page.evaluate('window.scrollTo(0, 0)')
```

#### 5. –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ timeout'—ã
```python
page.goto(url, wait_until='domcontentloaded', timeout=60000)  # 60 —Å–µ–∫—É–Ω–¥
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–û (—Å –æ—à–∏–±–∫–æ–π):
```
‚ùå Timeout 30000ms exceeded
```

### –ü–û–°–õ–ï (—Ä–∞–±–æ—Ç–∞–µ—Ç!):
```
‚úÖ –£—Å–ø–µ—à–Ω–æ!
üìã –ó–∞–≥–æ–ª–æ–≤–æ–∫: –ü—Ä–æ–¥–∞–µ—Ç—Å—è 2-–∫–æ–º–Ω. –∫–≤–∞—Ä—Ç–∏—Ä–∞, 60,24 –º¬≤
üí∞ –¶–µ–Ω–∞: 20 000 000 ‚ÇΩ
üìç –ê–¥—Ä–µ—Å: –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, —Ä-–Ω –í—ã–±–æ—Ä–≥—Å–∫–∏–π...
üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫: 17 (–≤–∫–ª—é—á–∞—è –≠–¢–ê–ñ: 11/12!)
üì∑ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 20
```

### –¢–µ—Å—Ç –Ω–∞ 2 URL:
| URL | –°—Ç–∞—Ç—É—Å | –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ | –§–æ—Ç–æ |
|-----|--------|--------------|------|
| https://spb.cian.ru/sale/flat/315047056/ | ‚úÖ | 17 | 20 |
| https://www.cian.ru/sale/flat/315831388/ | ‚úÖ | 10 | 20 |

**–£—Å–ø–µ—à–Ω–æ—Å—Ç—å: 2/2 (100%)**

---

## üéÅ –ë–û–ù–£–°: –¢–µ–ø–µ—Ä—å –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –≠–¢–ê–ñ!

–î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ meta tags:
```python
og_title = page.locator('meta[property="og:title"]').first
content = og_title.get_attribute('content')
# "–ü—Ä–æ–¥–∞—ë—Ç—Å—è 3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ ... —ç—Ç–∞–∂ 4/6"
floor_match = re.search(r'—ç—Ç–∞–∂ (\d+/\d+)', content, re.IGNORECASE)
if floor_match:
    characteristics['–≠—Ç–∞–∂'] = floor_match.group(1)
```

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **[src/cian_parser_stealth.py](src/cian_parser_stealth.py)**
   - –ü–∞—Ä—Å–µ—Ä —Å –ø–æ–ª–Ω—ã–º anti-detection
   - –°–æ–≤–º–µ—Å—Ç–∏–º —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º API
   - Alias: `CianParserEnhanced = CianParserStealth`

2. **[get_three_listings_full.py](get_three_listings_full.py)**
   - Standalone —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
   - –ü–æ–ª–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏–∫
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ JSON

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ:
- **[webapp/app_enhanced.py](webapp/app_enhanced.py)**
  - –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç stealth –ø–∞—Ä—Å–µ—Ä
  - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 5001

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
```
http://127.0.0.1:5001
```

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í—Å—Ç–∞–≤—å—Ç–µ –õ–Æ–ë–£–Æ —Å—Å—ã–ª–∫—É Cian.ru (–¥–∞–∂–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ!)
3. –ü–æ–ª—É—á–∏—Ç–µ –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### Python API:
```python
from src.cian_parser_stealth import CianParserStealth

with CianParserStealth(headless=True) as parser:
    result = parser.parse_detail_page_full(url)
    
# result —Å–æ–¥–µ—Ä–∂–∏—Ç:
# - 10-17 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–≤–∫–ª—é—á–∞—è –≠–¢–ê–ñ!)
# - –î–æ 30 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
# - –ê–¥—Ä–µ—Å, –º–µ—Ç—Ä–æ, —Ü–µ–Ω—É, –æ–ø–∏—Å–∞–Ω–∏–µ
```

---

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ä–∞—è Playwright | Stealth Playwright |
|---------|------------------|-------------------|
| **–û–±—Ö–æ–¥ Cloudflare** | ‚ùå Timeout | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫** | 4-9 | **10-17** ‚úÖ |
| **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç—Ç–∞–∂–∞** | ‚ùå | ‚úÖ **–î–∞!** |
| **Timeout** | 30 —Å–µ–∫ | 60 —Å–µ–∫ |
| **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å** | 50-60% | **100%** ‚úÖ |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | 10-15 —Å–µ–∫ | 15-20 —Å–µ–∫ |

---

## üéØ –ß—Ç–æ –±—ã–ª–æ –∑–∞–ø—Ä–æ—à–µ–Ω–æ –∏ —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- [x] **–ê–¥—Ä–µ—Å** - –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è
- [x] **–≠—Ç–∞–∂** - –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è! (–∏–∑ meta tags)
- [x] **–ú–µ—Ç—Ä–∞–∂** (–ø–ª–æ—â–∞–¥—å) - –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è
- [x] **–í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏** - 10-17 —à—Ç
- [x] –û–±—Ö–æ–¥ Cloudflare timeout - —Ä–∞–±–æ—Ç–∞–µ—Ç!
- [x] –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ - –¥–æ 30 —à—Ç
- [x] –¶–µ–Ω–∞, —Ü–µ–Ω–∞ –∑–∞ –º¬≤
- [x] –°—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ

### üîÑ –ß–∞—Å—Ç–∏—á–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–∞–π—Ç–µ):
- [ ] **–í—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–æ–≤** - –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- [ ] **–ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ –¥–æ–º–µ** - –∫–Ω–æ–ø–∫–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã
- [ ] **–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–¥–∞–∂** - –≤–æ–∑–º–æ–∂–Ω–æ, premium feature

### üí° –ü–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã:
1. **–í—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–æ–≤** - —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ ~20% –æ–±—ä—è–≤–ª–µ–Ω–∏–π
2. **–ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è** - –∫–Ω–æ–ø–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–µ –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–æ–≤
3. **–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–¥–∞–∂** - –≤–∫–ª–∞–¥–∫–∏ –Ω–µ—Ç –Ω–∞ –æ–±—ã—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

---

## üèÜ –ò—Ç–æ–≥–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå Timeout errors –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö URL
- ‚ö†Ô∏è 4-9 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- ‚ùå –ù–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —ç—Ç–∞–∂–∞

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ **100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å** –ø–∞—Ä—Å–∏–Ω–≥–∞
- ‚úÖ **10-17 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫** (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤ 2-3 —Ä–∞–∑–∞!)
- ‚úÖ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç—Ç–∞–∂–∞** (–±—ã–ª–æ –∑–∞–ø—Ä–æ—à–µ–Ω–æ!)
- ‚úÖ –û–±—Ö–æ–¥ Cloudflare –∑–∞—â–∏—Ç—ã
- ‚úÖ –ü–æ–ª–Ω–∞—è anti-detection —Å–∏—Å—Ç–µ–º–∞

---

## üéì –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏:
1. ‚úÖ –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ webdriver
2. ‚úÖ –≠–º—É–ª—è—Ü–∏—è –ø–ª–∞–≥–∏–Ω–æ–≤ –±—Ä–∞—É–∑–µ—Ä–∞
3. ‚úÖ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ User-Agent –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏
4. ‚úÖ –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
5. ‚úÖ –≠–º—É–ª—è—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞
6. ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ timeout'—ã
7. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞ Chrome

### –ò–∑—É—á–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- Nodriver (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω, –Ω–µ –ø–æ–¥–æ—à–µ–ª)
- Camoufox (–∏–∑—É—á–µ–Ω, –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)
- FlareSolverr (–∏–∑—É—á–µ–Ω, —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–µ–Ω)

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ:
- [ZenRows: Bypass Cloudflare 2025](https://www.zenrows.com/blog/bypass-cloudflare)
- [ScrapingAnt: Open Source Libraries](https://scrapingant.com/blog/open-source-web-scraping-libraries-bypass-anti-bot)
- [Nodriver GitHub](https://github.com/ultrafunkamsterdam/nodriver)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [Playwright Stealth](https://playwright.dev/docs/next/emulation)
- [Anti-Detection Best Practices](https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/)

---

## üéâ –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê!

‚úÖ **–í–µ–±-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω:** http://127.0.0.1:5001  
‚úÖ **–ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç** –Ω–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö URL  
‚úÖ **–ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –≠–¢–ê–ñ** (–±—ã–ª–æ –≤ –∑–∞–ø—Ä–æ—Å–µ!)  
‚úÖ **10-17 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫** –≤–º–µ—Å—Ç–æ 4-9  
‚úÖ **100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å** –≤–º–µ—Å—Ç–æ 50-60%  

---

**Made with ‚ù§Ô∏è using Playwright + Anti-Detection Techniques**  
**–î–∞—Ç–∞ —Ä–µ—à–µ–Ω–∏—è:** 3 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 4.0 Stealth Edition
