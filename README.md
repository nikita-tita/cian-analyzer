# Cian.ru Parser

–ü–∞—Ä—Å–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏–π –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å —Å–∞–π—Ç–∞ Cian.ru

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ–∏—Å–∫–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏
- –ü–∞—Ä—Å–∏–Ω–≥ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: —Ü–µ–Ω–∞, –∞–¥—Ä–µ—Å, –º–µ—Ç—Ä–æ, –ø–ª–æ—â–∞–¥—å, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫: —Å–ª—É—á–∞–π–Ω—ã–µ User-Agent, –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ JSON –∏ Markdown** ‚ú®
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Playwright –¥–ª—è –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd cian
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example:
```bash
cp .env.example .env
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

```python
from src.cian_parser import CianParser

# –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—Å–µ—Ä —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
parser = CianParser(delay=2.0)

# –ü–∞—Ä—Å–∏–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞
url = "https://www.cian.ru/cat.php?deal_type=sale&engine_version=2&offer_type=flat&region=1"
listings = parser.parse_search_page(url)

# –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
for listing in listings:
    print(f"{listing['title']} - {listing['price']}")

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ JSON
parser.save_to_json(listings, 'results.json')
```

### –ü–∞—Ä—Å–∏–Ω–≥ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

```python
from src.cian_parser import CianParser

parser = CianParser(delay=2.0)

# –ü–∞—Ä—Å–∏–º –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
url = "https://www.cian.ru/sale/flat/123456789/"
detail = parser.parse_detail_page(url)

print(f"–ó–∞–≥–æ–ª–æ–≤–æ–∫: {detail['title']}")
print(f"–¶–µ–Ω–∞: {detail['price']}")
print(f"–û–ø–∏—Å–∞–Ω–∏–µ: {detail['description']}")
print(f"–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: {detail['characteristics']}")
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤

```bash
cd examples
python example_usage.py
```

### üìù –≠–∫—Å–ø–æ—Ä—Ç –≤ Markdown

**–ù–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å!** –¢–µ–ø–µ—Ä—å –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —É–¥–æ–±–Ω–æ–º Markdown —Ñ–æ—Ä–º–∞—Ç–µ:

```bash
python parse_with_playwright.py
```

–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –¥–≤–∞ —Ñ–∞–π–ª–∞:
- `playwright_results_YYYYMMDD_HHMMSS.json` - –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `cian_results_YYYYMMDD_HHMMSS.md` - –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è

Markdown —Ñ–∞–π–ª –≤–∫–ª—é—á–∞–µ—Ç:
- ‚úÖ –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏
- üìë –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å —è–∫–æ—Ä—è–º–∏
- üó∫Ô∏è –°—Å—ã–ª–∫–∏ –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã
- üì∑ –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ
- üèòÔ∏è –ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- üîç –í—Å–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

**–î–µ–º–æ-–≤–µ—Ä—Å–∏—è:**
```bash
python demo_markdown_export.py
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [MARKDOWN_EXPORT.md](MARKDOWN_EXPORT.md)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ö–∞—Ä—Ç–æ—á–∫–∞ –∏–∑ –ø–æ–∏—Å–∫–∞
```python
{
    'title': str,          # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
    'price': str,          # –¶–µ–Ω–∞
    'address': str,        # –ê–¥—Ä–µ—Å
    'metro': str,          # –ë–ª–∏–∂–∞–π—à–µ–µ –º–µ—Ç—Ä–æ
    'area': str,           # –ü–ª–æ—â–∞–¥—å
    'floor': str,          # –≠—Ç–∞–∂
    'rooms': str,          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
    'url': str,            # –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
    'image_url': str       # URL –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
}
```

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
```python
{
    'url': str,                    # URL –æ–±—ä—è–≤–ª–µ–Ω–∏—è
    'title': str,                  # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    'price': str,                  # –¶–µ–Ω–∞
    'description': str,            # –û–ø–∏—Å–∞–Ω–∏–µ
    'address': str,                # –ê–¥—Ä–µ—Å
    'metro': list,                 # –°–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω—Ü–∏–π –º–µ—Ç—Ä–æ
    'characteristics': dict,        # –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (–ø–ª–æ—â–∞–¥—å, —ç—Ç–∞–∂, –∏ —Ç.–¥.)
    'images': list,                # –°–ø–∏—Å–æ–∫ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    'seller': {                    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥–∞–≤—Ü–µ
        'name': str,
        'type': str
    }
}
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ Cian.ru

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL –¥–ª—è –ø–æ–∏—Å–∫–∞:

- `deal_type` - —Ç–∏–ø —Å–¥–µ–ª–∫–∏:
  - `sale` - –ø—Ä–æ–¥–∞–∂–∞
  - `rent` - –∞—Ä–µ–Ω–¥–∞

- `offer_type` - —Ç–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏:
  - `flat` - –∫–≤–∞—Ä—Ç–∏—Ä–∞
  - `suburban` - –∑–∞–≥–æ—Ä–æ–¥–Ω–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å
  - `commercial` - –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å

- `region` - —Ä–µ–≥–∏–æ–Ω:
  - `1` - –ú–æ—Å–∫–≤–∞
  - `2` - –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥

- `room1`, `room2`, `room3` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç (1 –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è)

–ü—Ä–∏–º–µ—Ä URL:
```
https://www.cian.ru/cat.php?deal_type=sale&engine_version=2&offer_type=flat&region=1&room1=1
```

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–£–≤–∞–∂–∞–π—Ç–µ robots.txt** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏** - –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π—Ç–µ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—Ä–æ—Å–∞–º–∏
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** - —Å–∞–π—Ç –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –∏–ª–∏ –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–µ–≥–∞–ª—å–Ω–æ—Å—Ç—å** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞—Ä—Å–∏–Ω–≥ –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- Cian.ru –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –±–æ—Ç–æ–≤ (Cloudflare, –∫–∞–ø—á–∞)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ HTML –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è - –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
- –î–ª—è –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Selenium –∏–ª–∏ –ø—Ä–æ–∫—Å–∏

## –†–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É Selenium –¥–ª—è –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–∫—Å–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV, Excel
- [ ] –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (aiohttp)
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω
- [ ] Telegram –±–æ—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

–≠—Ç–æ—Ç –ø–∞—Ä—Å–µ—Ä —Å–æ–∑–¥–∞–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —É—Å–ª–æ–≤–∏—è–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è Cian.ru –∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ–º—É –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É.
