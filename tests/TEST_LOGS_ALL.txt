2025-11-12 20:41:27,346 - __main__ - INFO - ╔==============================================================================╗
2025-11-12 20:41:27,347 - __main__ - INFO - ║                    ТЕСТИРОВАНИЕ ДОРАБОТОК #1-5                               ║
2025-11-12 20:41:27,347 - __main__ - INFO - ╚==============================================================================╝
2025-11-12 20:41:27,347 - __main__ - INFO - 
2025-11-12 20:41:27,347 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,347 - __main__ - INFO - ТЕСТ: Определение региона из URL (Доработка #1)
2025-11-12 20:41:27,347 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,347 - __main__ - INFO - URL: https://moskva.cian.ru/sale/flat/123/...
2025-11-12 20:41:27,347 - __main__ - INFO -   Ожидаемый регион: msk
2025-11-12 20:41:27,347 - __main__ - INFO -   Определенный регион: msk
2025-11-12 20:41:27,347 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,347 - __main__ - INFO - 
2025-11-12 20:41:27,347 - __main__ - INFO - URL: https://spb.cian.ru/sale/flat/456/...
2025-11-12 20:41:27,347 - __main__ - INFO -   Ожидаемый регион: spb
2025-11-12 20:41:27,347 - __main__ - INFO -   Определенный регион: spb
2025-11-12 20:41:27,347 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,347 - __main__ - INFO - 
2025-11-12 20:41:27,347 - __main__ - INFO - URL: https://sankt-peterburg.cian.ru/sale/flat/789/...
2025-11-12 20:41:27,347 - __main__ - INFO -   Ожидаемый регион: spb
2025-11-12 20:41:27,347 - __main__ - INFO -   Определенный регион: spb
2025-11-12 20:41:27,347 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,347 - __main__ - INFO - 
2025-11-12 20:41:27,347 - __main__ - INFO - URL: https://www.cian.ru/sale/flat/012/...
2025-11-12 20:41:27,347 - __main__ - INFO -   Ожидаемый регион: spb
2025-11-12 20:41:27,347 - __main__ - INFO -   Определенный регион: spb
2025-11-12 20:41:27,347 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,347 - __main__ - INFO - 
2025-11-12 20:41:27,347 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,347 - __main__ - INFO - ТЕСТ: Адаптивные диапазоны поиска (Доработка #2)
2025-11-12 20:41:27,347 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,347 - __main__ - INFO - [Тест 1: Элитная недвижимость Москва] Сегмент определен: элитная
2025-11-12 20:41:27,347 - __main__ - INFO - [Тест 1: Элитная недвижимость Москва] Допуски: цена ±20%, площадь ±15%
2025-11-12 20:41:27,347 - __main__ - INFO - [Тест 1: Элитная недвижимость Москва] Диапазон цен: 344,000,000 - 516,000,000 ₽
2025-11-12 20:41:27,347 - __main__ - INFO - [Тест 1: Элитная недвижимость Москва] Диапазон площади: 268 - 363 м²
2025-11-12 20:41:27,347 - __main__ - INFO - [Тест 1: Элитная недвижимость Москва] ✅ PASSED
2025-11-12 20:41:27,348 - __main__ - INFO - 
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 2: Премиум СПБ] Сегмент определен: премиум
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 2: Премиум СПБ] Допуски: цена ±30%, площадь ±25%
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 2: Премиум СПБ] Диапазон цен: 105,000,000 - 195,000,000 ₽
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 2: Премиум СПБ] Диапазон площади: 90 - 150 м²
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 2: Премиум СПБ] ✅ PASSED
2025-11-12 20:41:27,348 - __main__ - INFO - 
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 3: Средний+ Москва] Сегмент определен: средний+
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 3: Средний+ Москва] Допуски: цена ±40%, площадь ±30%
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 3: Средний+ Москва] Диапазон цен: 30,000,000 - 70,000,000 ₽
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 3: Средний+ Москва] Диапазон площади: 52 - 97 м²
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 3: Средний+ Москва] ✅ PASSED
2025-11-12 20:41:27,348 - __main__ - INFO - 
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 4: Эконом СПБ] Сегмент определен: эконом
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 4: Эконом СПБ] Допуски: цена ±50%, площадь ±40%
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 4: Эконом СПБ] Диапазон цен: 9,000,000 - 27,000,000 ₽
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 4: Эконом СПБ] Диапазон площади: 30 - 70 м²
2025-11-12 20:41:27,348 - __main__ - INFO - [Тест 4: Эконом СПБ] ✅ PASSED
2025-11-12 20:41:27,348 - __main__ - INFO - 
2025-11-12 20:41:27,348 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,348 - __main__ - INFO - ТЕСТ: Валидация разумности аналогов (Доработка #3)
2025-11-12 20:41:27,348 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,348 - __main__ - INFO - Аналог: test1.com
2025-11-12 20:41:27,348 - __main__ - INFO -   Цена: 95,000,000 ₽ (ratio: 1.05)
2025-11-12 20:41:27,348 - __main__ - INFO -   Площадь: 98 м² (ratio: 1.02)
2025-11-12 20:41:27,348 - __main__ - INFO -   Валидность: ✅ Валиден
2025-11-12 20:41:27,348 - __main__ - INFO -   Причина: ОК
2025-11-12 20:41:27,348 - __main__ - INFO - 
2025-11-12 20:41:27,348 - __main__ - INFO - Аналог: test2.com
2025-11-12 20:41:27,348 - __main__ - INFO -   Цена: 20,000,000 ₽ (ratio: 5.00)
2025-11-12 20:41:27,348 - __main__ - INFO -   Площадь: 100 м² (ratio: 1.00)
2025-11-12 20:41:27,348 - __main__ - INFO -   Валидность: ❌ Исключен
2025-11-12 20:41:27,348 - __main__ - INFO -   Причина: Цена отличается в 5.0 раз
2025-11-12 20:41:27,348 - __main__ - INFO - 
2025-11-12 20:41:27,348 - __main__ - INFO - Аналог: test3.com
2025-11-12 20:41:27,348 - __main__ - INFO -   Цена: 100,000,000 ₽ (ratio: 1.00)
2025-11-12 20:41:27,348 - __main__ - INFO -   Площадь: 40 м² (ratio: 2.50)
2025-11-12 20:41:27,348 - __main__ - INFO -   Валидность: ❌ Исключен
2025-11-12 20:41:27,348 - __main__ - INFO -   Причина: Площадь отличается в 2.5 раз
2025-11-12 20:41:27,348 - __main__ - INFO - 
2025-11-12 20:41:27,348 - __main__ - INFO - Аналог: test4.com
2025-11-12 20:41:27,348 - __main__ - INFO -   Цена: 350,000,000 ₽ (ratio: 3.50)
2025-11-12 20:41:27,349 - __main__ - INFO -   Площадь: 100 м² (ratio: 1.00)
2025-11-12 20:41:27,349 - __main__ - INFO -   Валидность: ❌ Исключен
2025-11-12 20:41:27,349 - __main__ - INFO -   Причина: Цена отличается в 3.5 раз
2025-11-12 20:41:27,349 - __main__ - INFO - 
2025-11-12 20:41:27,349 - __main__ - INFO - Аналог: test5.com
2025-11-12 20:41:27,349 - __main__ - INFO -   Цена: 110,000,000 ₽ (ratio: 1.10)
2025-11-12 20:41:27,349 - __main__ - INFO -   Площадь: 120 м² (ratio: 1.20)
2025-11-12 20:41:27,349 - __main__ - INFO -   Валидность: ✅ Валиден
2025-11-12 20:41:27,349 - __main__ - INFO -   Причина: ОК
2025-11-12 20:41:27,349 - __main__ - INFO - 
2025-11-12 20:41:27,349 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,349 - __main__ - INFO - ТЕСТ: Генерация предупреждений о качестве (Доработка #4)
2025-11-12 20:41:27,349 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,355 - __main__ - INFO - Сценарий 1: Мало аналогов (3)
2025-11-12 20:41:27,355 - __main__ - INFO -   Warnings: 1
2025-11-12 20:41:27,355 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,355 - __main__ - INFO - 
2025-11-12 20:41:27,355 - __main__ - INFO - Сценарий 2: Большой разброс цен (CV=45%)
2025-11-12 20:41:27,355 - __main__ - INFO -   CV: 33%
2025-11-12 20:41:27,355 - __main__ - INFO -   Warnings: 1
2025-11-12 20:41:27,356 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,356 - __main__ - INFO - 
2025-11-12 20:41:27,356 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,356 - __main__ - INFO - ТЕСТ: Фильтрация по локации (Доработка #5)
2025-11-12 20:41:27,356 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,356 - __main__ - INFO - Тест 1: Строгая фильтрация (по метро)
2025-11-12 20:41:27,356 - __main__ - INFO -   ✓ test1: метро 'Арбатская' совпадает
2025-11-12 20:41:27,356 - __main__ - INFO -   ✗ test2: метро 'Смоленская' не совпадает
2025-11-12 20:41:27,356 - __main__ - INFO -   ✗ test3: метро 'Кропоткинская' не совпадает
2025-11-12 20:41:27,356 - __main__ - INFO -   ✓ test4: метро 'Арбатская-Покровская' совпадает
2025-11-12 20:41:27,356 - __main__ - INFO -   Результат: 2 из 4 (ожидается 2)
2025-11-12 20:41:27,356 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,356 - __main__ - INFO - 
2025-11-12 20:41:27,356 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,356 - __main__ - INFO - ТЕСТ: Многоуровневый поиск (Доработка #5)
2025-11-12 20:41:27,356 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,356 - __main__ - INFO - Сценарий 1: Достаточно аналогов на уровне 1 (>=10)
2025-11-12 20:41:27,356 - __main__ - INFO -   Уровень 1: 12 аналогов
2025-11-12 20:41:27,356 - __main__ - INFO -   ✓ Поиск завершается на уровне 1
2025-11-12 20:41:27,356 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,356 - __main__ - INFO - 
2025-11-12 20:41:27,356 - __main__ - INFO - Сценарий 2: Мало аналогов на уровне 1 (<10), переход к уровню 2
2025-11-12 20:41:27,356 - __main__ - INFO -   Уровень 1: 7 аналогов
2025-11-12 20:41:27,356 - __main__ - INFO -   Уровень 2: +5 аналогов (итого: 12)
2025-11-12 20:41:27,356 - __main__ - INFO -   ✓ Достаточно аналогов после уровня 2
2025-11-12 20:41:27,356 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,356 - __main__ - INFO - 
2025-11-12 20:41:27,357 - __main__ - INFO - Сценарий 3: Мало аналогов на уровнях 1-2 (<5), нужен уровень 3
2025-11-12 20:41:27,357 - __main__ - INFO -   Уровень 1: 2 аналогов
2025-11-12 20:41:27,357 - __main__ - INFO -   Уровень 2: +2 аналогов (итого: 4)
2025-11-12 20:41:27,357 - __main__ - INFO -   ✓ Переход к уровню 3 (расширенный поиск)
2025-11-12 20:41:27,357 - __main__ - INFO -   Уровень 3: +10 аналогов (итого: 14)
2025-11-12 20:41:27,357 - __main__ - INFO -   ✅ PASSED
2025-11-12 20:41:27,357 - __main__ - INFO - 
2025-11-12 20:41:27,357 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,357 - __main__ - INFO - ТЕСТ: Расширение допусков на уровне 3 (Доработка #5)
2025-11-12 20:41:27,357 - __main__ - INFO - ================================================================================
2025-11-12 20:41:27,357 - __main__ - INFO - Сегмент: элитная (400,000,000 ₽)
2025-11-12 20:41:27,357 - __main__ - INFO -   Базовые допуски: цена ±20%, площадь ±15%
2025-11-12 20:41:27,357 - __main__ - INFO -   Уровень 3: цена ±30%, площадь ±22%
2025-11-12 20:41:27,357 - __main__ - INFO -   ✅ Допуски расширены корректно
2025-11-12 20:41:27,357 - __main__ - INFO - 
2025-11-12 20:41:27,357 - __main__ - INFO - Сегмент: премиум (150,000,000 ₽)
2025-11-12 20:41:27,357 - __main__ - INFO -   Базовые допуски: цена ±30%, площадь ±25%
2025-11-12 20:41:27,357 - __main__ - INFO -   Уровень 3: цена ±45%, площадь ±38%
2025-11-12 20:41:27,357 - __main__ - INFO -   ✅ Допуски расширены корректно
2025-11-12 20:41:27,357 - __main__ - INFO - 
2025-11-12 20:41:27,357 - __main__ - INFO - Сегмент: эконом (20,000,000 ₽)
2025-11-12 20:41:27,357 - __main__ - INFO -   Базовые допуски: цена ±50%, площадь ±40%
2025-11-12 20:41:27,357 - __main__ - INFO -   Уровень 3: цена ±75%, площадь ±60%
2025-11-12 20:41:27,357 - __main__ - INFO -   ✅ Допуски расширены корректно
2025-11-12 20:41:27,357 - __main__ - INFO - 
2025-11-12 20:41:27,357 - __main__ - INFO - ✅ ВСЕ СЕГМЕНТЫ PASSED
2025-11-12 20:41:27,357 - __main__ - INFO - 
2025-11-12 20:41:27,357 - __main__ - INFO - ╔==============================================================================╗
2025-11-12 20:41:27,357 - __main__ - INFO - ║                    ВСЕ ТЕСТЫ ПРОЙДЕНЫ ✅ (7 тестов)                           ║
2025-11-12 20:41:27,357 - __main__ - INFO - ╚==============================================================================╝
