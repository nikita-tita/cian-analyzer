# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è production –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–î–∞—Ç–∞:** 2025-01-13
**–°—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è:** ‚úÖ PR #20 —Å–º–µ—Ä–∂–µ–Ω, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ production (commit 05a279b)
**–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ production

### –ó–∞–¥–µ–ø–ª–æ–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚úÖ

```bash
git log origin/main --oneline -5

05a279b hotfix: Add skip_on_failure=True to root_validator
4034c1f Merge pull request #20 (–Ω–∞—à–∏ 4 –ø–∞—Ç—á–∞)
27156ed docs: Add technical analysis of production Step 3 failure
7f51b62 fix: Implement robust analysis with graceful degradation (4 patches)
```

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –Ω–∞ production:**
- ‚úÖ ParseResult dataclass —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (13 —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤ async_parser.py)
- ‚úÖ min_comparables_required = 1 (–±—ã–ª–æ 3)
- ‚úÖ Adaptive IQR (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ n‚â•5)
- ‚úÖ Field recovery (price ‚Üî price_per_sqm ‚Üî total_area)
- ‚úÖ root_validator —Å skip_on_failure=True (hotfix)

---

## –¢–µ—Å—Ç #1: –ö–≤–∞—Ä—Ç–∏—Ä–∞ 213.4 –º¬≤ (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ç–µ—Å—Ç)

**–û–±—ä–µ–∫—Ç:** https://www.cian.ru/sale/flat/305062289/
- –ü–ª–æ—â–∞–¥—å: 213.4 –º¬≤
- –ö–æ–º–Ω–∞—Ç: 5
- –ú–æ—Å–∫–≤–∞, –ø–µ—Ä–µ—É–ª–æ–∫ –ö–æ—Ä–æ–±–µ–π–Ω–∏–∫–æ–≤
- –£—Ä–æ–≤–µ–Ω—å –æ—Ç–¥–µ–ª–∫–∏: —á–µ—Ä–Ω–æ–≤–∞—è (—É–∫–∞–∑–∞–Ω –≤—Ä—É—á–Ω—É—é)

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

#### Step 1: –ó–∞–≥—Ä—É–∑–∫–∞ ‚úÖ
- –î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –≤—Ä—É—á–Ω—É—é

#### Step 2: –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤ ‚úÖ
- **–ù–∞–π–¥–µ–Ω–æ: 8 –∞–Ω–∞–ª–æ–≥–æ–≤**
- –í—Å–µ –∏–∑ –ú–æ—Å–∫–≤—ã (–•–∞–º–æ–≤–Ω–∏–∫–∏, –ü—Ä–µ—Å–Ω–µ–Ω—Å–∫–∏–π, –ê—Ä–±–∞—Ç)
- –î–∏–∞–ø–∞–∑–æ–Ω: 175-315 –º¬≤, 170-430 –º–ª–Ω ‚ÇΩ
- –ü—Ä–∏–º–µ—Ä—ã:
  - "–ó–æ–ª–æ—Ç–∞—è –º–∏–ª—è" 315.7 –º¬≤, 430 –º–ª–Ω ‚ÇΩ
  - –ú–Ω–æ–≥–æ–∫–æ–º–Ω–∞—Ç–Ω—ã–µ 260.1 –º¬≤ (200 –º–ª–Ω ‚ÇΩ), 303 –º¬≤ (275 –º–ª–Ω ‚ÇΩ)

#### Step 3: –ê–Ω–∞–ª–∏–∑ ‚ùå **–ü–†–û–í–ê–õ–ò–õ–°–Ø**

**–û—à–∏–±–∫–∞:**
```
–ö—Ä–∞—Å–Ω–∞—è –ø–ª–∞—à–∫–∞: "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"
```

**–ß—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:**
- –¢–æ–ª—å–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∏–∫–∏ ("–û –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ")
- –ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å –æ—Ç—á—ë—Ç" (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"
- ‚ùå –ù–ï–¢ —Ç–∞–±–ª–∏—Ü, —Ä–∞—Å—á–µ—Ç–æ–≤, –∏—Ç–æ–≥–æ–≤—ã—Ö —Ü–µ–Ω

**–í—ã–≤–æ–¥:**
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É—Å–ø–µ—à–Ω—ã–π –ø–æ–∏—Å–∫ 8 –∞–Ω–∞–ª–æ–≥–æ–≤ (–≤—Å–µ –∏–∑ –ú–æ—Å–∫–≤—ã), –∞–Ω–∞–ª–∏–∑ –≤—Å–µ –µ—â–µ –ø–∞–¥–∞–µ—Ç.
–ù–∞—à–∏ —Ñ–∏–∫—Å—ã –ù–ï —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É –ø–æ–ª–Ω–æ—Å—Ç—å—é.

---

## –¢–µ—Å—Ç #2: –ö–≤–∞—Ä—Ç–∏—Ä–∞ 260.1 –º¬≤ (–Ω–æ–≤—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –æ–±—ä–µ–∫—Ç)

**–û–±—ä–µ–∫—Ç:** https://cian.ru/sale/flat/322444729/
- –ü–ª–æ—â–∞–¥—å: 260.1 –º¬≤
- –ö–æ–º–Ω–∞—Ç: –ú–Ω–æ–≥–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è
- –ú–æ—Å–∫–≤–∞, –ö—Ä–∞—Å–Ω–æ–ø—Ä–µ—Å–Ω–µ–Ω—Å–∫–∞—è –Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è
- –¶–µ–Ω–∞: 200 000 000 ‚ÇΩ (‚âà 768 935 ‚ÇΩ/–º¬≤)
- –£—Ä–æ–≤–µ–Ω—å –æ—Ç–¥–µ–ª–∫–∏: –ø—Ä–µ–º–∏—É–º (–¥–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∏–π —Ä–µ–º–æ–Ω—Ç)

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

#### Step 1: –ó–∞–≥—Ä—É–∑–∫–∞ ‚úÖ
- –î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –£—Ä–æ–≤–µ–Ω—å –æ—Ç–¥–µ–ª–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω "–ø—Ä–µ–º–∏—É–º"

#### Step 2: –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤ ‚ùå **–ù–ï –†–ê–ë–û–¢–ê–ï–¢**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
–ù–∞–π–¥–µ–Ω–æ: 0 –∞–Ω–∞–ª–æ–≥–æ–≤
–ö—Ä–∞—Å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–ê–Ω–∞–ª–æ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã ‚Äì –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–ø–æ–∏—Å–∫–∞ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∞–Ω–∞–ª–æ–≥–∏ –≤—Ä—É—á–Ω—É—é"
```

**–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å:**
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ Step 3: "–°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"
- –ê–Ω–∞–ª–∏–∑ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**–í—ã–≤–æ–¥:**
–î–ª—è —ç–ª–∏—Ç–Ω–æ–π/–ø—Ä–µ–º–∏—É–º –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ (260.1 –º¬≤, 200 –º–ª–Ω ‚ÇΩ) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π
–ø–æ–∏—Å–∫ –ù–ï –Ω–∞—Ö–æ–¥–∏—Ç –∞–Ω–∞–ª–æ–≥–æ–≤ –≤–æ–æ–±—â–µ.

---

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞ #1: Step 3 –ø–∞–¥–∞–µ—Ç –¥–ª—è 213.4 –º¬≤ (8 –∞–Ω–∞–ª–æ–≥–æ–≤)

**–°—Ç–∞—Ç—É—Å:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0

**–û–∂–∏–¥–∞–ª–æ—Å—å –ø–æ—Å–ª–µ —Ñ–∏–∫—Å–æ–≤:**
- Graceful degradation –¥–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å
- –ê–Ω–∞–ª–∏–∑ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ –¥–∞–∂–µ —Å –ø—Ä–æ–±–ª–µ–º–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –∫–∞—á–µ—Å—Ç–≤–µ –≤–º–µ—Å—Ç–æ "—á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫"

**–†–µ–∞–ª—å–Ω–æ—Å—Ç—å:**
- Step 3 –≤—Å–µ –µ—â–µ –ø–∞–¥–∞–µ—Ç —Å generic error
- –û—Ç—á–µ—Ç –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- –ù–∞—à–∏ —Ñ–∏–∫—Å—ã –ù–ï –ø–æ–º–æ–≥–ª–∏

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

1. **Frontend –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫**
   - Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ error_type
   - Frontend –≤—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "—á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫"

2. **–ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ pipeline**
   - –í–æ–∑–º–æ–∂–Ω–æ –æ—à–∏–±–∫–∞ –≤ calculate_market_statistics()
   - –ò–ª–∏ –≤ generate_price_scenarios()
   - –ò–ª–∏ –≤ recommendation engine

3. **Pydantic ValidationError –≤—Å–µ –µ—â–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**
   - –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ skip_on_failure=True
   - –í–æ–∑–º–æ–∂–Ω–æ ValidationError –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ (–Ω–µ –≤ root_validator)

4. **JavaScript –æ—à–∏–±–∫–∞ –Ω–∞ frontend**
   - –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –ò–ª–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ response –æ—Ç /api/analyze

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ production: `journalctl -u housler -n 100`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å browser console –Ω–∞ housler.ru
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ analyzer.py
- –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–µ–Ω debug —Ä–µ–∂–∏–º –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

---

### –ü—Ä–æ–±–ª–µ–º–∞ #2: 0 –∞–Ω–∞–ª–æ–≥–æ–≤ –¥–ª—è 260.1 –º¬≤ (–ø—Ä–µ–º–∏—É–º)

**–°—Ç–∞—Ç—É—Å:** üü° –í—ã—Å–æ–∫–∞—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ–±—ä–µ–∫—Ç–∞:**
- –¶–µ–Ω–∞: 200 –º–ª–Ω ‚ÇΩ ‚Üí —Å–µ–≥–º–µ–Ω—Ç "–ø—Ä–µ–º–∏—É–º" (100-300 –º–ª–Ω)
- –ü–ª–æ—â–∞–¥—å: 260.1 –º¬≤
- –î–æ–ø—É—Å–∫–∏: ¬±30% —Ü–µ–Ω–∞, ¬±25% –ø–ª–æ—â–∞–¥—å

**–û–∂–∏–¥–∞–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –ø–æ–∏—Å–∫–∞:**
- –¶–µ–Ω–∞: 140-260 –º–ª–Ω ‚ÇΩ
- –ü–ª–æ—â–∞–¥—å: 195-325 –º¬≤
- –ö–æ–º–Ω–∞—Ç—ã: –º–Ω–æ–≥–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è (likely 4-5-6)

**–ü–æ—á–µ–º—É –º–æ–≥–ª–æ –Ω–µ –Ω–∞–π—Ç–∏:**

1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å room_type**
   ```python
   # –ï—Å–ª–∏ room_type = "–º–Ω–æ–≥–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è" (—Å—Ç—Ä–æ–∫–∞)
   # –ü–∞—Ä—Å–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —á–∏—Å–ª–æ
   # –í–æ–∑–º–æ–∂–Ω–æ –æ—à–∏–±–∫–∞ –≤ —ç—Ç–æ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏
   ```

2. **Multilevel search –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø–ª–æ—â–∞–¥–µ–π**
   - Level 1: strict (¬±20% price, ¬±15% area) ‚Üí 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - Level 2: medium (¬±30% price, ¬±25% area) ‚Üí 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - Level 3: wide (¬±40% price, ¬±35% area) ‚Üí 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –ï—Å–ª–∏ –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 0 ‚Üí –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç = 0

3. **–ü–∞—Ä—Å–∏–Ω–≥ –ø–æ–∏—Å–∫–æ–≤–æ–π –≤—ã–¥–∞—á–∏ –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è**
   - –¶–∏–∞–Ω –≤–µ—Ä–Ω—É–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –Ω–æ –ø–∞—Ä—Å–µ—Ä –Ω–µ —Å–º–æ–≥ –∏—Ö –∏–∑–≤–ª–µ—á—å
   - –ò–ª–∏ –¶–∏–∞–Ω –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –∑–∞–ø—Ä–æ—Å (rate limiting/captcha)

4. **–†–µ–≥–∏–æ–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –Ω–µ–≤–µ—Ä–Ω–æ**
   - –ö—Ä–∞—Å–Ω–æ–ø—Ä–µ—Å–Ω–µ–Ω—Å–∫–∞—è –Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è ‚Üí –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ú–æ—Å–∫–≤–∞
   - –ù–æ –≤–æ–∑–º–æ–∂–Ω–æ –ø–∞—Ä—Å–µ—Ä –æ–ø—Ä–µ–¥–µ–ª–∏–ª –∫–∞–∫ –¥—Ä—É–≥–æ–π —Ä–µ–≥–∏–æ–Ω
   - –ò –∏—â–µ—Ç –Ω–µ —Ç–∞–º

**–¢–µ—Å—Ç–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**

–í—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∏—Å–∫ –Ω–∞ –¶–∏–∞–Ω:
```
https://www.cian.ru/cat.php?deal_type=sale&offer_type=flat
&region=1                    # –ú–æ—Å–∫–≤–∞
&price_min=140000000         # -30%
&price_max=260000000         # +30%
&minArea=195                 # -25%
&maxArea=325                 # +25%
&room4=1&room5=1&room6=1     # –ú–Ω–æ–≥–æ–∫–æ–º–Ω–∞—Ç–Ω—ã–µ
```

–ï—Å–ª–∏ –¶–∏–∞–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –Ω–∞—à–µ–º –ø–∞—Ä—Å–µ—Ä–µ.
–ï—Å–ª–∏ –¶–∏–∞–Ω –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ‚Üí –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–æ–≤ (—Ä–µ–¥–∫–∏–π —Å–µ–≥–º–µ–Ω—Ç).

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –¥–ª—è —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞: –∫–∞–∫–∏–µ URL —Å—Ç—Ä–æ—è—Ç—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¶–∏–∞–Ω –ø–æ —ç—Ç–∏–º URL
- –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ–ø—É—Å–∫–∏ –¥–ª—è –ø—Ä–µ–º–∏—É–º —Å–µ–≥–º–µ–Ω—Ç–∞
- –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å Level 4 —Å –µ—â–µ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏

---

## –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã

### –°—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è: ‚úÖ –£—Å–ø–µ—à–Ω–æ
- PR #20 —Å–º–µ—Ä–∂–µ–Ω
- –í—Å–µ 4 –ø–∞—Ç—á–∞ –Ω–∞ production
- Hotfix –¥–æ–±–∞–≤–ª–µ–Ω (skip_on_failure=True)

### –°—Ç–∞—Ç—É—Å —Ñ–∏–∫—Å–æ–≤: ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ Step 2 –ø–æ–∏—Å–∫ —É–ª—É—á—à–µ–Ω (–Ω–µ—Ç –º–∏–∫—Å–æ–≤ –°–ü–±/–ú–æ—Å–∫–≤–∞)
- ‚úÖ Retry –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ—Ç –º–∞—Å—Å–æ–≤—ã—Ö timeout –≤ –ª–æ–≥–∞—Ö, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)
- ‚úÖ Field recovery —Ä–∞–±–æ—Ç–∞–µ—Ç (–∏–Ω–∞—á–µ –±—ã–ª–æ –±—ã 0 –∞–Ω–∞–ª–æ–≥–æ–≤ –≤–º–µ—Å—Ç–æ 8)

**–ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚ùå Step 3 –≤—Å–µ –µ—â–µ –ø–∞–¥–∞–µ—Ç –¥–ª—è 213.4 –º¬≤ (8 –∞–Ω–∞–ª–æ–≥–æ–≤)
- ‚ùå Step 2 –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –∞–Ω–∞–ª–æ–≥–æ–≤ –¥–ª—è 260.1 –º¬≤ (–ø—Ä–µ–º–∏—É–º —Å–µ–≥–º–µ–Ω—Ç)

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

**–°—Ä–æ—á–Ω–æ (P0):**
1. –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ production –ª–æ–≥–∞–º –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ Step 3
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å browser console –Ω–∞ housler.ru (JavaScript errors?)
3. –î–æ–±–∞–≤–∏—Ç—å debug endpoint –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
4. –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–µ–Ω –µ—â–µ –æ–¥–∏–Ω –ø–∞—Ç—á –¥–ª—è frontend error handling

**–í–∞–∂–Ω–æ (P1):**
1. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ—á–µ–º—É –¥–ª—è 260.1 –º¬≤ –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å multilevel search –ª–æ–≥–∏–∫—É –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø–ª–æ—â–∞–¥–µ–π
3. –í–æ–∑–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ–ø—É—Å–∫–∏ –¥–ª—è –ø—Ä–µ–º–∏—É–º —Å–µ–≥–º–µ–Ω—Ç–∞ (¬±40% –≤–º–µ—Å—Ç–æ ¬±30%)

**–ú–æ–∂–Ω–æ –ø–æ–∑–∂–µ (P2):**
1. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ (parse quality, success rate –ø–æ —à–∞–≥–∞–º)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
3. –°–æ–∑–¥–∞—Ç—å dashboard —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –¥–ª—è debugging

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ production:

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@91.229.8.221

# –õ–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
journalctl -u housler -n 100 --no-pager

# –ò—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏ Step 3
journalctl -u housler | grep -A 10 "305062289\|–∞–Ω–∞–ª–∏–∑\|analyze"

# –ò—Å–∫–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø–∞—Ä—Å–∏–Ω–≥–∞
journalctl -u housler | grep -E "ParseResult|retry|quality_metrics"
```

### Browser console –Ω–∞ housler.ru:

```javascript
// –û—Ç–∫—Ä—ã—Ç—å DevTools (F12)
// Console tab
// –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ Step 3 —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞:
// - Network tab ‚Üí /api/analyze ‚Üí Response
// - Console ‚Üí JavaScript errors
// - Network ‚Üí /api/analyze ‚Üí Status code (200? 422? 500?)
```

### Debug endpoint (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å):

```python
# app_new.py
@app.route('/api/debug/analyze/<session_id>', methods=['GET'])
def debug_analyze(session_id):
    """Debug endpoint –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞ –∞–Ω–∞–ª–∏–∑–∞"""
    session_data = session_storage.get(session_id)

    return jsonify({
        'comparables_count': len(session_data.get('comparables', [])),
        'comparables_sample': session_data.get('comparables', [])[:2],
        'target_property': session_data.get('target_property'),
        'step': 'ready_for_analysis'
    })
```

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ production –ª–æ–≥–∞–º –¥–ª—è —Ç–æ—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
