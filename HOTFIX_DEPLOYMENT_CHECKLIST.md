# üî• HOTFIX: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Backend –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Ñ–∏–∫—Å–æ–≤

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ production:
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç (–ø–∞—Ä—Å–µ—Ä –æ–±–Ω–æ–≤–∏–ª—Å—è)
- ‚ùå ROI —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏ –≤—Å—ë –µ—â—ë –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 888.9x (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 888.9%)
- ‚ùå –ú–µ–¥–∏–∞–Ω–∞ —Ä—ã–Ω–∫–∞ –≤—Å—ë –µ—â—ë 318K (–Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞)

**–î–∏–∞–≥–Ω–æ–∑:** Backend –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª—Å—è –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ .pyc —Ñ–∞–π–ª—ã –∏–ª–∏ –∫—ç—à.

---

## üöÄ –†–ï–®–ï–ù–ò–ï: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ Docker (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

```bash
cd /path/to/cian-analyzer

# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
git log --oneline -1

# 2. –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ
git checkout claude/fix-calculator-cache-012gx1QboU4oheReMotiVvDg
git pull origin claude/fix-calculator-cache-012gx1QboU4oheReMotiVvDg

# 3. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# 4. –£–î–ê–õ–Ø–ï–ú —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–∑—ã
docker-compose rm -f
docker rmi cian-analyzer_web

# 5. –ß–∏—Å—Ç–∏–º Python –∫—ç—à
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true
find . -type f -name "*.pyc" -delete

# 6. –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –ë–ï–ó –∫—ç—à–∞
docker-compose build --no-cache

# 7. –ó–∞–ø—É—Å–∫–∞–µ–º —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞
docker-compose up -d

# 8. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
docker-compose logs -f --tail=50
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Gunicorn (–µ—Å–ª–∏ –±–µ–∑ Docker)

```bash
# 1. –ù–∞—Ö–æ–¥–∏–º –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep gunicorn

# 2. –£–±–∏–≤–∞–µ–º –í–°–ï –ø—Ä–æ—Ü–µ—Å—Å—ã gunicorn
pkill -9 gunicorn

# 3. –ß–∏—Å—Ç–∏–º Python –∫—ç—à
cd /path/to/cian-analyzer
find . -type d -name "__pycache__" -exec rm -rf {} +
find . -type f -name "*.pyc" -delete

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ systemd (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
sudo systemctl restart housler
# –ò–õ–ò –Ω–∞–ø—Ä—è–º—É—é
gunicorn --bind 0.0.0.0:5000 --workers 4 app_new:app
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: Slash –∫–æ–º–∞–Ω–¥–∞ /stop + /deploy

```bash
# 1. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
/stop

# 2. –ß–∏—Å—Ç–∏–º –∫—ç—à –≤—Ä—É—á–Ω—É—é
rm -rf __pycache__
rm -rf src/**/__pycache__
find . -name "*.pyc" -delete

# 3. –î–µ–ø–ª–æ–∏–º —Å–Ω–æ–≤–∞
/deploy
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ ROI —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏ (–¥–æ–ª–∂–Ω–æ —Å—Ç–∞—Ç—å ~800-900%)
```bash
# –í –±—Ä–∞—É–∑–µ—Ä–µ:
1. Ctrl+Shift+R (–∂–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)
2. –û—Ç–∫—Ä—ã—Ç—å –æ–±—ä–µ–∫—Ç
3. –†–∞—Å–∫—Ä—ã—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é "–£–ª—É—á—à–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏"
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ROI:
   ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ROI: 888.9% (–∏–ª–∏ 8.9x)
   ‚ùå –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë: ROI: 888.9x (–º–Ω–æ–∂–∏—Ç–µ–ª—å)
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–¥–∏–∞–Ω—ã (–¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å—Å—è)
```bash
# –í –±—Ä–∞—É–∑–µ—Ä–µ:
1. –û—Ç–∫—Ä—ã—Ç—å –æ–±—ä–µ–∫—Ç
2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å "–ú–µ–¥–∏–∞–Ω–∞ —Ä—ã–Ω–∫–∞"
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ:
   - –î–ª—è 3-–∫–æ–º–Ω 77–º¬≤: ~250-280K ‚ÇΩ/–º¬≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–Ω–∞–ª–æ–≥–æ–≤)
   - –ï—Å–ª–∏ –µ—Å—Ç—å –ñ–ö –≤ –∞–¥—Ä–µ—Å–µ: –ª–æ–≥ –ø–æ–∫–∞–∂–µ—Ç "–ù–∞–π–¥–µ–Ω–æ N –∞–Ω–∞–ª–æ–≥–æ–≤ –∏–∑ —Ç–æ–≥–æ –∂–µ –ñ–ö"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ backend
```bash
# Docker:
docker-compose logs web | grep -i "weighted median\|—Ñ–æ—Ç–æ—Å–µ—Å—Å–∏—è\|roi"

# –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
# - "üìç –ù–∞–π–¥–µ–Ω–æ N –∞–Ω–∞–ª–æ–≥–æ–≤ –∏–∑ —Ç–æ–≥–æ –∂–µ –ñ–ö" (–µ—Å–ª–∏ –µ—Å—Ç—å –ñ–ö)
# - "ROI —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏: 888.9%" (–Ω–µ x!)
```

---

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–∏–ª–∏—Å—å
cd /path/to/cian-analyzer

# –ü—Ä–æ–≤–µ—Ä—è–µ–º recommendations.py
grep -n "time_value = current_price" src/analytics/recommendations.py
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞ 347: time_value = current_price * monthly_rate * time_saved_months

# –ü—Ä–æ–≤–µ—Ä—è–µ–º liquidity_profile.py
grep -n "_calculate_weighted_median" src/analytics/liquidity_profile.py
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞ 121: def _calculate_weighted_median(

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–≥–º–µ–Ω—Ç—ã
grep -n "comfort.*400_000" src/analytics/liquidity_profile.py
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞ 14: ("comfort", 400_000),
```

---

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "x" –≤–º–µ—Å—Ç–æ "%"
**–°–∏–º–ø—Ç–æ–º:** ROI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "888.9x"
**–ü—Ä–∏—á–∏–Ω–∞:** Frontend –∫–æ–¥ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç ROI
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —à–∞–±–ª–æ–Ω –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ROI –≤ HTML/JS

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
```bash
# –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º ROI
grep -r "roi" templates/
grep -r "ROI.*x" static/
grep -r "888" templates/
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ú–µ–¥–∏–∞–Ω–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
**–°–∏–º–ø—Ç–æ–º:** –í—Å—ë –µ—â—ë –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 318K
**–ü—Ä–∏—á–∏–Ω–∞:** –£ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ—Ç –ñ–ö –≤ –∞–¥—Ä–µ—Å–µ ‚Üí fallback –Ω–∞ –æ–±—ã—á–Ω—É—é –º–µ–¥–∏–∞–Ω—É
**–†–µ—à–µ–Ω–∏–µ:** –ù–æ—Ä–º–∞–ª—å–Ω–æ, –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω –ñ–ö

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# –í Python –∫–æ–Ω—Å–æ–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
from src.analytics.liquidity_profile import _extract_residential_complex

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥—Ä–µ—Å –æ–±—ä–µ–∫—Ç–∞
address = "—É–ª. –®–∞—Ä–∏–∫–æ–ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤—Å–∫–∞—è, 40"  # –ü—Ä–∏–º–µ—Ä
result = _extract_residential_complex(address)
print(result)  # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å None –µ—Å–ª–∏ –Ω–µ—Ç "–ñ–ö"
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —É—Å–ø–µ—à–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

- [ ] Backend –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω (Docker restart / Gunicorn restart)
- [ ] Python –∫—ç—à —É–¥–∞–ª—ë–Ω (__pycache__, *.pyc)
- [ ] Git –≤–µ—Ä—Å–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ = `ad1a392` (–ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç)
- [ ] –ë—Ä–∞—É–∑–µ—Ä –æ–±–Ω–æ–≤–ª—ë–Ω (Ctrl+Shift+R)
- [ ] ROI —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–ø—Ä–æ—Ü–µ–Ω—Ç**, –Ω–µ –º–Ω–æ–∂–∏—Ç–µ–ª—å
- [ ] –ú–µ–¥–∏–∞–Ω–∞ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª–∞—Å—å (–∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª–æ–≥ –æ –ñ–ö)
- [ ] –°–µ–≥–º–µ–Ω—Ç—ã –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å (–∫–æ–º—Ñ–æ—Ä—Ç –¥–æ 400K)

---

## üìû –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Git –≤–µ—Ä—Å–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   cd /path/to/cian-analyzer
   git log --oneline -1
   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ad1a392 docs: comprehensive production deployment guide
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å:**
   ```bash
   md5sum src/analytics/recommendations.py
   md5sum src/analytics/liquidity_profile.py
   # –°—Ä–∞–≤–Ω–∏—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ md5
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ debug —Ä–µ–∂–∏–º–µ:**
   ```bash
   export FLASK_DEBUG=1
   python app_new.py
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—ä–µ–∫—Ç–∞
   ```

---

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:**
- ‚úÖ ROI —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏: **888.9%** (–∏–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
- ‚úÖ –ú–µ–¥–∏–∞–Ω–∞: –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–∞ —Å —É—á—ë—Ç–æ–º –ñ–ö (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ –∞–¥—Ä–µ—Å–µ)
- ‚úÖ –°–µ–≥–º–µ–Ω—Ç—ã: –∫–æ–º—Ñ–æ—Ä—Ç –¥–æ 400K ‚ÇΩ/–º¬≤
- ‚úÖ –í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç

**–í–µ—Ç–∫–∞:** `claude/fix-calculator-cache-012gx1QboU4oheReMotiVvDg`
**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç:** `ad1a392`
