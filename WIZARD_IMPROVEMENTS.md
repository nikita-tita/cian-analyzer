# üéØ –£–ª—É—á—à–µ–Ω–∏—è Wizard - –û—Ç—á–µ—Ç

**–î–∞—Ç–∞**: 8 –Ω–æ—è–±—Ä—è 2025, 13:11 MSK
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. üóëÔ∏è –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –±—ã–ª–∏ –∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –∏ –≤ floating footer
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ: "–ù–∞–∑–∞–¥" –∏ "–î–∞–ª–µ–µ" –ø–æ—è–≤–ª—è–ª–∏—Å—å –¥–≤–∞–∂–¥—ã

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã floating buttons –∏–∑ HTML (—Å—Ç—Ä–æ–∫–∏ 448-458)
- ‚úÖ –£–¥–∞–ª–µ–Ω –æ–±—ä–µ–∫—Ç floatingButtons –∏–∑ JS (~48 —Å—Ç—Ä–æ–∫)
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã floatingButtons.init() –∏ updateButtons()

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ß–∏—Å—Ç—ã–π –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

### 2. üéØ Progress Bar —Ç–µ–ø–µ—Ä—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –ö–ª–∏–∫ –ø–æ –ª—é–±–æ–º—É —à–∞–≥—É –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –Ω–∞ –Ω–µ–≥–æ
- ‚úÖ Hover —ç—Ñ—Ñ–µ–∫—Ç (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∞)
- ‚úÖ –ó–∞—â–∏—Ç–∞: –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–π—Ç–∏ –±–µ–∑ sessionId

**CSS:**
```css
.progress-step {
    cursor: pointer;
}

.progress-step:hover .step-circle {
    transform: scale(1.1);
    border-color: var(--color-accent);
}
```

---

### 3. üîó URL —Ö—ç—à–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ `#step-1` - –®–∞–≥ 1: –û–±—ä–µ–∫—Ç
- ‚úÖ `#step-2` - –®–∞–≥ 2: –ê–Ω–∞–ª–æ–≥–∏  
- ‚úÖ `#step-3` - –®–∞–≥ 3: –ê–Ω–∞–ª–∏–∑

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–æ–∂–Ω–æ –¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥
- –ò—Å—Ç–æ—Ä–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∫–Ω–æ–ø–∫–∞ –ù–∞–∑–∞–¥)
- Deep linking –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä:**
```
https://housler.ru/calculator#step-2
```

**–ó–∞—â–∏—Ç–∞:**
- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ step-2/3 —Ç—Ä–µ–±—É–µ—Ç sessionId
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Å—Å–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### templates/wizard.html
```diff
- –°—Ç—Ä–æ–∫–∏ 448-458: –£–¥–∞–ª–µ–Ω—ã floating buttons
  ‚úÖ –ë—ã–ª–æ: 464 —Å—Ç—Ä–æ–∫–∏
  ‚úÖ –°—Ç–∞–ª–æ: 453 —Å—Ç—Ä–æ–∫–∏
```

### static/js/wizard.js
```diff
- –£–¥–∞–ª–µ–Ω –æ–±—ä–µ–∫—Ç floatingButtons (~48 —Å—Ç—Ä–æ–∫)
- –£–¥–∞–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã floatingButtons.updateButtons()
+ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ URL —Ö—ç—à–µ–π
+ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–ª–∏–∫—É –Ω–∞ progress-step
+ –î–æ–±–∞–≤–ª–µ–Ω hashchange event listener
  ‚úÖ –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º state.sessionId
```

### static/css/wizard.css
```diff
+ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã—Ö —à–∞–≥–æ–≤
+ Hover —ç—Ñ—Ñ–µ–∫—Ç—ã
```

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ù–∞–≤–∏–≥–∞—Ü–∏—è

**1. –ö–ª–∏–∫ –ø–æ Progress Step:**
```javascript
step.addEventListener('click', () => {
    const stepNum = parseInt(step.dataset.step);

    if (stepNum === 1 || state.sessionId) {
        navigation.goToStep(stepNum);
    } else {
        showToast('–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ...', 'warning');
    }
});
```

**2. URL Hash Update:**
```javascript
navigation.goToStep = function(step) {
    // –û–±–Ω–æ–≤–ª—è–µ–º URL
    window.location.hash = 'step-' + step;

    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç–∫—Ä–∞–Ω
    originalGoToStep.call(this, step);
};
```

**3. Hash Change Handling:**
```javascript
window.addEventListener('hashchange', () => {
    const match = hash.match(/#step-(\d+)/);
    if (match && state.sessionId) {
        navigation.goToStep(step);
    }
});
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

### –¢–µ—Å—Ç 1: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://housler.ru/calculator
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ
3. ‚úÖ –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –í –ö–û–ù–¢–ï–ù–¢–ï
4. ‚ùå –ù–ï–¢ floating –∫–Ω–æ–ø–æ–∫ –≤–Ω–∏–∑—É
```

### –¢–µ—Å—Ç 2: –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π Progress Bar
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://housler.ru/calculator
2. –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ "–®–∞–≥ 2" –∏–ª–∏ "–®–∞–≥ 3"
3. ‚úÖ –ö—É—Ä—Å–æ—Ä pointer
4. ‚úÖ Hover —ç—Ñ—Ñ–µ–∫—Ç
5. –ö–ª–∏–∫–Ω–∏—Ç–µ (–±–µ–∑ sessionId)
6. ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: "–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ"
```

### –¢–µ—Å—Ç 3: URL –•—ç—à–∏
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://housler.ru/calculator#step-1
2. ‚úÖ URL —Å–æ–¥–µ—Ä–∂–∏—Ç #step-1
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —à–∞–≥ 2
4. ‚úÖ URL –æ–±–Ω–æ–≤–∏–ª—Å—è –Ω–∞ #step-2
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É, –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
6. ‚úÖ –î–æ–ª–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å —à–∞–≥ 2 (–µ—Å–ª–∏ sessionId —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è)
```

---

## ‚ö†Ô∏è Session Handling

### –ò–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞ –Ω–∞ —à–∞–≥–µ 3:** "–°–µ—Å—Å–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

**–ü—Ä–∏—á–∏–Ω–∞:**
- Session ID —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `state.sessionId` –≤ JS
- –°–µ—Å—Å–∏–∏ –≤ Redis –∏–º–µ—é—Ç TTL = 3600s (1 —á–∞—Å)
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã state —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
–ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å sessionId –≤:
1. LocalStorage
2. –ò–ª–∏ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–µ (query string)
3. –ò–ª–∏ Cookie

**–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
- –ù–µ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
- Session —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

---

## üìä –ò—Ç–æ–≥

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
- ‚úÖ Progress bar –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π
- ‚úÖ URL —Ö—ç—à–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Deep linking –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- ‚ö†Ô∏è –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ sessionId –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- ‚ö†Ô∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ state –∏–∑ sessionId

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ sessionId
```javascript
// –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ localStorage
localStorage.setItem('housler_session', state.sessionId);

// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
const savedSession = localStorage.getItem('housler_session');
if (savedSession) {
    state.sessionId = savedSession;
}
```

### 2. Query String –ø–æ–¥—Ö–æ–¥
```
https://housler.ru/calculator?session=uuid-here#step-2
```

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 08.11.2025 13:11 MSK
**URL:** https://housler.ru/calculator
**–°—Ç–∞—Ç—É—Å:** üü¢ –†–∞–±–æ—Ç–∞–µ—Ç
