# üöÄ –£–ª—É—á—à–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø–∞—Ä—Å–µ—Ä–æ–≤

## üìã –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –ø–æ–∏—Å–∫–∞.

### ‚ú® –ß—Ç–æ –Ω–æ–≤–æ–≥–æ

1. **–ú—É–ª—å—Ç–∏–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –¶–∏–∞–Ω, –î–æ–º–∫–ª–∏–∫, –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –Ω–æ–≤—ã—Ö
2. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –ï–¥–∏–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞** - –ü–æ URL –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω—É–∂–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
4. **–ì–∏–±–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞** - –û—Ç –ø–æ–∏—Å–∫–∞ –≤ —Ç–æ–º –∂–µ –ñ–ö –¥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≤—Å–µ–º—É –≥–æ—Ä–æ–¥—É
5. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫** - –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–ª–æ—â–∞–¥–∫–∞–º
6. **–ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         MultiSourceSearchStrategy           ‚îÇ
‚îÇ  (–ü–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           ParserRegistry                    ‚îÇ
‚îÇ  (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞ –ø–æ URL)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚ñº                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ CianParser   ‚îÇ    ‚îÇDomClickParser‚îÇ
‚îÇ              ‚îÇ    ‚îÇ              ‚îÇ
‚îÇ - Playwright ‚îÇ    ‚îÇ - Playwright ‚îÇ
‚îÇ - Caching    ‚îÇ    ‚îÇ - JSON API   ‚îÇ
‚îÇ - Search     ‚îÇ    ‚îÇ - __INIT__   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                   ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      BaseRealEstateParser (Interface)       ‚îÇ
‚îÇ  - parse_detail_page()                      ‚îÇ
‚îÇ  - search_similar()                         ‚îÇ
‚îÇ  - get_capabilities()                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìù –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. BaseRealEstateParser

–ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä.

**–§–∞–π–ª**: `src/parsers/base_real_estate_parser.py`

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
- `parse_detail_page(url)` - –ü–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- `search_similar(target, strategy)` - –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤
- `get_capabilities()` - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∞
- `get_source_name()` - –ò–º—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞

### 2. ParserRegistry

–†–µ–µ—Å—Ç—Ä –ø–∞—Ä—Å–µ—Ä–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º –ø–æ URL.

**–§–∞–π–ª**: `src/parsers/parser_registry.py`

**–§—É–Ω–∫—Ü–∏–∏**:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–æ URL
- –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä

### 3. CianParser (–∞–¥–∞–ø—Ç–µ—Ä)

–û–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `PlaywrightParser` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –Ω–æ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

**–§–∞–π–ª**: `src/parsers/cian_parser_adapter.py`

### 4. DomClickParser

–ù–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –î–æ–º–∫–ª–∏–∫–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- –ò–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ `window.__INITIAL_STATE__`
- JSON-LD structured data
- HTML fallback –ø–∞—Ä—Å–∏–Ω–≥

**–§–∞–π–ª**: `src/parsers/domclick_parser.py`

### 5. MultiSourceSearchStrategy

–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–µ–π.

**–§–∞–π–ª**: `src/parsers/multi_source_search.py`

### 6. FieldMapper

–°–∏—Å—Ç–µ–º–∞ –º–∞–ø–ø–∏–Ω–≥–∞ –ø–æ–ª–µ–π –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

**–§–∞–π–ª**: `src/parsers/field_mapper.py`

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ - –ø–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

```python
from src.parsers.parser_registry import get_global_registry

# –ü–æ–ª—É—á–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä
registry = get_global_registry()

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞ –ø–æ URL
url = "https://www.cian.ru/sale/flat/123456/"
parser = registry.get_parser(url)

# –ü–∞—Ä—Å–∏–º –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
data = parser.parse_detail_page(url)

print(f"–ò—Å—Ç–æ—á–Ω–∏–∫: {data['source']}")
print(f"–¶–µ–Ω–∞: {data['price']} {data['currency']}")
print(f"–ü–ª–æ—â–∞–¥—å: {data['total_area']} –º¬≤")
```

### –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ

```python
from src.parsers.cian_parser_adapter import CianParser

# –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—Å–µ—Ä
parser = CianParser(region='spb')

# –¶–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç
target = {
    'price': 5000000,
    'total_area': 50,
    'rooms': 2,
    'metro': ['–ü–ª. –í–æ—Å—Å—Ç–∞–Ω–∏—è']
}

# –ü–æ–∏—Å–∫ –≤ —Ç–æ–º –∂–µ –ñ–ö
similar = parser.search_similar(
    target_property=target,
    limit=20,
    strategy='same_building'
)

print(f"–ù–∞–π–¥–µ–Ω–æ –∞–Ω–∞–ª–æ–≥–æ–≤: {len(similar)}")
```

### –ú—É–ª—å—Ç–∏–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤—ã–π –ø–æ–∏—Å–∫

```python
from src.parsers.multi_source_search import MultiSourceSearchStrategy, SearchConfig

# –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
strategy = MultiSourceSearchStrategy()

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
config = SearchConfig(
    sources=['cian', 'domclick'],  # –ò–ª–∏ ['all'] –¥–ª—è –≤—Å–µ—Ö
    strategy='citywide',
    limit_per_source=30,
    parallel=True,
    merge_duplicates=True,
    sort_by='price'
)

# –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
results = strategy.search(target_property=target, config=config)

# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
by_source = {}
for result in results:
    source = result['source']
    by_source.setdefault(source, []).append(result)

for source, items in by_source.items():
    print(f"{source}: {len(items)} –æ–±—ä–µ–∫—Ç–æ–≤")
```

### –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º—É–ª—å—Ç–∏–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤—ã–π –ø–æ–∏—Å–∫

```python
from src.parsers.multi_source_search import search_across_sources

# –û–¥–∏–Ω –≤—ã–∑–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –≤—Å–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
results = search_across_sources(
    target_property={'price': 5000000, 'total_area': 50},
    sources=['cian', 'domclick'],
    strategy='citywide',
    limit_per_source=30
)
```

---

## üîß –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:

### 1. `same_building` - –í —Ç–æ–º –∂–µ –ñ–ö
–ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤ –≤ —Ç–æ–º –∂–µ –∂–∏–ª–æ–º –∫–æ–º–ø–ª–µ–∫—Å–µ. –°–∞–º—ã–µ —Ç–æ—á–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏.

### 2. `same_area` - –í —Ç–æ–º –∂–µ —Ä–∞–π–æ–Ω–µ
–ü–æ–∏—Å–∫ –≤ —Ç–æ–º –∂–µ —Ä–∞–π–æ–Ω–µ –∏–ª–∏ —É —Ç–æ–≥–æ –∂–µ –º–µ—Ç—Ä–æ.

### 3. `citywide` - –ü–æ –≤—Å–µ–º—É –≥–æ—Ä–æ–¥—É
–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤:
- **–£—Ä–æ–≤–µ–Ω—å 1**: –°—Ç—Ä–æ–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç–æ –∂–µ –º–µ—Ç—Ä–æ
- **–£—Ä–æ–≤–µ–Ω—å 2**: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å –≥–æ—Ä–æ–¥
- **–£—Ä–æ–≤–µ–Ω—å 3**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

---

## üé® –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å –ø–∞—Ä—Å–µ—Ä–∞

```python
from src.parsers.base_real_estate_parser import BaseRealEstateParser, ParserCapabilities
from src.parsers.parser_registry import register_parser

@register_parser('avito', [r'avito\.ru'])
class AvitoParser(BaseRealEstateParser):

    def _get_page_content(self, url: str):
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        pass

    def _parse_single_property(self, url: str, html: str):
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞
        pass

    def _search_similar_impl(self, target_property, limit, strategy):
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
        pass

    def get_capabilities(self):
        return ParserCapabilities(
            supports_search=True,
            supports_regions=['msk', 'spb'],
            requires_browser=True
        )

    def get_source_name(self):
        return 'avito'
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –º–∞–ø–ø–µ—Ä –ø–æ–ª–µ–π

–í —Ñ–∞–π–ª–µ `src/parsers/field_mapper.py`:

```python
def create_avito_mapper() -> FieldMapper:
    mapper = FieldMapper('avito')

    # –î–æ–±–∞–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥–∏ –ø–æ–ª–µ–π
    mapper.add_mapping('priceValue', 'price', transformer=float)
    mapper.add_mapping('areaValue', 'total_area', transformer=float)
    # ... –∏ —Ç.–¥.

    return mapper
```

### –®–∞–≥ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

```python
# –ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –±–ª–∞–≥–æ–¥–∞—Ä—è –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—É
results = search_across_sources(
    target_property=target,
    sources=['cian', 'domclick', 'avito']  # –ù–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫!
)
```

---

## üìä –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä–æ–≤

–ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä –∏–º–µ–µ—Ç —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

```python
from src.parsers.parser_registry import get_global_registry

registry = get_global_registry()

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–∞—Ö
info = registry.get_all_parsers_info()

for source, data in info.items():
    print(f"\n{source}:")
    print(f"  –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–∏—Å–∫–∞: {data['capabilities']['supports_search']}")
    print(f"  –ü–æ–∏—Å–∫ –ø–æ –ñ–ö: {data['capabilities']['supports_residential_complex']}")
    print(f"  –†–µ–≥–∏–æ–Ω—ã: {data['capabilities']['supports_regions']}")
    print(f"  Async: {data['capabilities']['supports_async']}")
    print(f"  API: {data['capabilities']['has_api']}")
```

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞

### –ë—ã–ª–æ (—Å—Ç–∞—Ä—ã–π –∫–æ–¥):

```python
from src.parsers.playwright_parser import PlaywrightParser

parser = PlaywrightParser(region='spb')
data = parser.parse_detail_page(url)
similar = parser.search_similar(target)
```

### –°—Ç–∞–ª–æ (–Ω–æ–≤—ã–π –∫–æ–¥):

```python
from src.parsers.parser_registry import get_global_registry

registry = get_global_registry()
parser = registry.get_parser(url)  # –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
data = parser.parse_detail_page(url)
similar = parser.search_similar(target)
```

**–í–∞–∂–Ω–æ**: –°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å! –ê–¥–∞–ø—Ç–µ—Ä `CianParser` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `PlaywrightParser` –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º.

---

## üö¶ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|----------|
| BaseRealEstateParser | ‚úÖ –ì–æ—Ç–æ–≤–æ | –ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| ParserRegistry | ‚úÖ –ì–æ—Ç–æ–≤–æ | –°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ |
| FieldMapper | ‚úÖ –ì–æ—Ç–æ–≤–æ | –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π |
| CianParser (–∞–¥–∞–ø—Ç–µ—Ä) | ‚úÖ –ì–æ—Ç–æ–≤–æ | –û–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ PlaywrightParser |
| DomClickParser | ‚ö†Ô∏è –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è | –¢—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ API |
| MultiSourceSearchStrategy | ‚úÖ –ì–æ—Ç–æ–≤–æ | –ú—É–ª—å—Ç–∏–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤—ã–π –ø–æ–∏—Å–∫ |
| –¢–µ—Å—Ç—ã | ‚ùå TODO | –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã |

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (3 –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –ø–æ 20 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
- –í—Ä–µ–º—è: ~60-90 —Å–µ–∫—É–Ω–¥
- –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏: 2 —Å–µ–∫—É–Ω–¥—ã

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (3 –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –ø–æ 20 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
- –í—Ä–µ–º—è: ~25-35 —Å–µ–∫—É–Ω–¥ (2-3x —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ThreadPoolExecutor

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- Redis –∫—ç—à –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- TTL: 24 —á–∞—Å–∞
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ: ~100x

---

## üéØ –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (Near-term)
- [ ] –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å API –î–æ–º–∫–ª–∏–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Å–µ—Ä –ê–≤–∏—Ç–æ
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (Mid-term)
- [ ] –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è MultiSourceSearchStrategy
- [ ] –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- [ ] ML-–º–æ–¥–µ–ª—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ö–æ–∂–µ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–æ–≤
- [ ] REST API –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (Long-term)
- [ ] –ü–∞—Ä—Å–µ—Ä—ã –¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø–ª–æ—â–∞–¥–æ–∫
- [ ] Real-time –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω
- [ ] –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–∞–º–∏ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–æ–≤

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **DomClickParser** - –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è, –ø–æ–∏—Å–∫ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–∑—É—á–µ–Ω–∏–µ API)
2. **–î—É–±–ª–∏–∫–∞—Ç—ã** - –∞–ª–≥–æ—Ä–∏—Ç–º –º–µ—Ä–¥–∂–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–æ—Å—Ç–æ–π (–ø–æ –∞–¥—Ä–µ—Å—É + –ø–ª–æ—â–∞–¥—å)
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω GIL (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —á–µ—Ä–µ–∑ multiprocessing)
4. **–†–µ–≥–∏–æ–Ω—ã** - –ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ –ú–æ—Å–∫–≤–∞ –∏ –°–ü–±

---

## ü§ù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –ø—Ä–æ–µ–∫—Ç–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π –∫–æ–¥ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á, —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:

```python
# –°—Ç–∞—Ä—ã–π –∫–æ–¥ (–ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)
from src.parsers.playwright_parser import PlaywrightParser
parser = PlaywrightParser()

# –ù–æ–≤—ã–π –∫–æ–¥ (–¥–ª—è –º—É–ª—å—Ç–∏–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)
from src.parsers.multi_source_search import search_across_sources
results = search_across_sources(target, sources=['cian', 'domclick'])
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

–ó–∞–º–µ–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç—ã –Ω–∞ –Ω–æ–≤—ã–µ:

```python
# –ë—ã–ª–æ
from src.parsers.playwright_parser import PlaywrightParser

# –°—Ç–∞–ª–æ
from src.parsers.cian_parser_adapter import CianParser as PlaywrightParser
# –ò–ª–∏
from src.parsers.parser_registry import get_global_registry
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
  - Strategy Pattern (–ø–æ–∏—Å–∫)
  - Factory Pattern (ParserRegistry)
  - Adapter Pattern (CianParser)
  - Facade Pattern (MultiSourceSearchStrategy)

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π**:
  - –°–º. docstrings –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ
  - –¢–∏–ø–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ type hints

---

## üí° –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–µ–π—Å–æ–≤

### –ö–µ–π—Å 1: –û—Ü–µ–Ω–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã –ø–æ –∞–Ω–∞–ª–æ–≥–∞–º –∏–∑ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

```python
from src.parsers.multi_source_search import search_across_sources

target = {
    'price': 8000000,
    'total_area': 65,
    'rooms': 2,
    'floor': 5,
    'metro': ['–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–∞—è']
}

# –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
analogs = search_across_sources(
    target_property=target,
    sources=['all'],
    strategy='citywide',
    limit_per_source=50
)

# –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã
prices = [a['price'] for a in analogs if a.get('price')]
avg_price = sum(prices) / len(prices)

print(f"–ù–∞–π–¥–µ–Ω–æ {len(analogs)} –∞–Ω–∞–ª–æ–≥–æ–≤")
print(f"–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: {avg_price:,.0f} ‚ÇΩ")
print(f"–¶–µ–Ω–∞ –∑–∞ –º¬≤: {avg_price / target['total_area']:,.0f} ‚ÇΩ/–º¬≤")
```

### –ö–µ–π—Å 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ –ñ–ö –Ω–∞ –≤—Å–µ—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö

```python
from src.parsers.parser_registry import get_global_registry

registry = get_global_registry()

# –°–ø–∏—Å–æ–∫ URL —Å —Ä–∞–∑–Ω—ã—Ö –ø–ª–æ—â–∞–¥–æ–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ñ–ö
urls = [
    "https://www.cian.ru/zhk-novyj-kompleks/",
    "https://domclick.ru/zhk/novyj-kompleks/",
]

all_offers = []

for url in urls:
    parser = registry.get_parser(url)
    if parser:
        # –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –≤ –ñ–ö
        offers = parser.search_similar(
            {'residential_complex': '–ù–æ–≤—ã–π –ö–æ–º–ø–ª–µ–∫—Å'},
            strategy='same_building',
            limit=100
        )
        all_offers.extend(offers)

print(f"–í—Å–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: {len(all_offers)}")
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
2. **–ì–∏–±–∫–æ—Å—Ç—å** - —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è + –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
5. **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - type hints –¥–ª—è IDE
6. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - —á–µ—Ç–∫–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è mock'–æ–≤
7. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –ø–∞—Ä—Å–µ—Ä—É

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ.
